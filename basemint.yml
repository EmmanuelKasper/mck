    - name: download mint {{ version }} distribution
      get_url:
        url: "https://bintray.com/freemint/freemint/download_file?file_path=snapshots%2F1-19-2a88f753%2Ffreemint-1-19-2a8-000-st_ste.zip"
        dest: "{{ playbook_dir }}/freemint-{{ version }}-000-st_ste.zip"
        force: no

    - name: create folder structure
      file:
        path: "{{ item }}"
        state: directory
      loop:
        - freemint
        - build/auto
        - build/distrib

    - name: unpack freemint archive
      unarchive:
        src: freemint-{{ version }}-000-st_ste.zip
        dest: "freemint"
        creates: "freemint/auto/mint-{{ minor_version }}.prg"

    - name: copy freemint kernel
      copy:
        src: freemint/auto/mint-{{ minor_version }}.prg
        dest: build/auto/mint-{{ minor_version }}.prg

    - name : copy freemint sysdir
      shell: cp -r freemint/mint build/
      args:
        creates: build/mint

    - name: remove default hostname
      replace:
        path: "build/mint/{{ version }}/mint.cnf"
        regexp : '^setenv HOSTNAME saturn$'
        replace: 'setenv HOSTNAME stmint'

    - name: download public domain okami shell
      get_url:
        url: https://sites.google.com/site/stessential/home/all-software/okamishl.zip
        dest: "{{ playbook_dir }}/okamishl.zip"
        force: no

    - name: extract okami shell
      shell: unzip okamishl.zip
      args:
        creates: OKAMI_SH.ELL/SH.TTP

    - name: fix unzip permissions
      file:
        path: "{{ item }}"
        mode: 0644
      loop:
        - OKAMI_SH.ELL/MSH.PRG
        - OKAMI_SH.ELL/MSH.INF
        - OKAMI_SH.ELL/SH.TTP
        - OKAMI_SH.ELL/PROFILE
        - OKAMI_SH.ELL/HELP

    - name: copy okami shell to 'distri' folder
      copy:
        src: "{{ item }}"
        dest: build/distrib/
      loop:
        - OKAMI_SH.ELL/MSH.PRG
        - OKAMI_SH.ELL/MSH.INF
        - OKAMI_SH.ELL/SH.TTP
        - OKAMI_SH.ELL/PROFILE
        - OKAMI_SH.ELL/HELP




